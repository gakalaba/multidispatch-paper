\subsection{Correctness Proof}
\label{sec:correctness}


\begin{lemma}
\label{lemma1}
Consider a pair of operations $e_1, e_2$ such that $e_1 <_p e_2$, and further assume each operation is coordinated and committed and been assigned timestamp $\varepsilon_1, \varepsilon_2$, respectively. Then, $\varepsilon_1 < \varepsilon_2$.
\end{lemma}
\begin{proof}
\end{proof}

\begin{lemma}
\label{lemma2}
Consider a pair of operations $e_1, e_2$ such that $e_1 <_x e_2$, and further assume each operation is coordinated and committed and been assigned timestamp $\varepsilon_1, \varepsilon_2$, respectively. Then, $\varepsilon_1 < \varepsilon_2$.
\end{lemma}
\begin{proof}
\end{proof}


Let $<_\psi$ be a partial order defined over pairs of complete operations $e_1, e_2$, as follows:
\begin{enumerate}
    \item $e_1 <_x e_2 \implies e_1 <_\psi e_2$
    \item $e_1 <_p e_2 \implies e_1 <_\psi e_2$
    \item $e_1 \rightarrow e_2 \implies e_1 <_\psi e_2$, and
    \item $e_1 <_\psi e_2 \land e_2 <_\psi e_3 \implies e_1 <_\psi e_3$
\end{enumerate}

\begin{lemma}
\label{lemmamain}
The partial order $<_\psi$ is acyclic.
\end{lemma}
\begin{proof}
We prove the lemma by contradiction, assuming the partial order contains a cycle. Consider a minimum cycle of $n$ operations $e_1,e_2,...,e_n$. Observe that $<_\psi$ is irreflexive by definition, so $n \geq 2$. First, we prove three useful properties of the minimum cycle.

\noindentparagraph{Property 1.} \textit{The cycle contains no consecutive $<_p$ edges.} {Assume for the sake of contradiction there exist two consecutive $<_p$ edges $e_i <_p e_{i+1} <_p e_{i+2}$. By the transitivity of $<_p$, there exists a shorter edge $e_i <_p e_{i+2}$ which is part of the shorter cycle $..., e_i, e_{i+2}, ..., e_i$, a contradiction.}
\noindentparagraph{Property 2.} \textit{The cycle contains no consecutive $<_x$ edges.} {Using similar reasoning as in the above, $e_i <_x e_{i+1} <_x e_{i+2}$ would imply the existence of a shorter cycle that contains the edge $e_i <_x e_{i+2}$, a contradiction.}
\noindentparagraph{Property 3.} \textit{The cycle contains at most 1 $\rightarrow$ edge.} Assume for the sake of contradiction that the cycle contains two $\rightarrow$ edges, $e_i \rightarrow e_j .... e_k \rightarrow e_l$, where $i < j \leq k < l$, reindexing the cycle if necessary. From the definition of $\rightarrow$, we know $resp(e_i) < inv(e_j)$ and $resp(e_k) < inv(e_l)$. We also know $inv(e_l) < resp(e_i)$, otherwise a shorter cycle would exist containing the edge $e_i \rightarrow e_l$. Similarly, we also know $inv(e_j) < resp(e_k)$, otherwise a shorter cycle would exist containing the edge $e_k \rightarrow e_j$. We arrive at a contradiction, since $resp(e_i) < inv(e_j) < resp(e_k) < inv(e_l) < resp(e_i)$, which gives $resp(e_i) < resp(e_i)$.

We carry on to prove $<_\psi$ is acyclic. By Property 3, we have two cases:
\noindentparagraph{Case 1.} Assume there are zero $\rightarrow$ edges in the minimum cycle. Since $n \geq 2$
By repeated application of Lemmas~\ref{lemma1} and ~\ref{lemma2}, we see $\varepsilon_1 < \varepsilon_n$. But by Lemma~\ref{lemma2}, $\varepsilon_n < \varepsilon_1$, a contradiction.
\noindentparagraph{Case 1.} Assume there is one $\rightarrow$ edges in the cycle.

\end{proof}